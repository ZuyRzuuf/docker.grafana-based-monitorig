<source>
  @type tail
  format nginx
  path /var/log/nginx/access.log
  pos_file /var/log/nginx/access.log.pos
  tag nginx.access
  read_from_head true
</source>

<filter nginx.access>
  @type record_transformer
  <record>
    time ${time}
    tag ${tag}
    remote_addr ${remote_addr}
    remote_user ${remote_user}
    request_method ${request_method}
    request_uri ${request_uri}
    status ${status}
    body_bytes_sent ${body_bytes_sent}
    http_referer ${http_referer}
    http_user_agent ${http_user_agent}
  </record>
</filter>

<match nginx.access>
  @type influxdb
  host influxdb
  port 8086
  dbname nginx
  user <your_influxdb_username>
  password <your_influxdb_password>
  time_precision s
  use_ssl false
  verify_ssl false
  <buffer>
    flush_interval 10s
    chunk_limit_size 1m
    queue_limit_length 256
    retry_forever true
  </buffer>
</match>
